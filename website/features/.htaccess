# Enable Rewrite Engine
RewriteEngine On

# Redirect users without a valid session to the root domain
RewriteCond %{HTTP_COOKIE} !PHPSESSID [NC]
RewriteRule ^(.*)$ / [R=302,L]

# Allow PHP execution but only for authenticated users
<FilesMatch "\.php$">
    Require all granted
</FilesMatch>
